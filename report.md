# Check LU decomposition

> LU разложение - разложение матрицы A на две матрицы, такие что:  
> L - нижнетреугольная матрица  
> U - верхнетреугольная матрица  
> L∙U = A

Matrix:

| 13,0 | 60,0 | 67,0 | 28,0 | 99,0 | 45,0 | 33,0 | 63,0 | 64,0 | 12,0 | 
| ---|---|---|---|---|---|---|---|---|---|
| **73,0** | **43,0** | **32,0** | **60,0** | **72,0** | **80,0** | **39,0** | **81,0** | **60,0** | **39,0** | 
| **27,0** | **32,0** | **88,0** | **25,0** | **93,0** | **47,0** | **62,0** | **7,0** | **18,0** | **65,0** | 
| **72,0** | **13,0** | **56,0** | **56,0** | **94,0** | **63,0** | **12,0** | **77,0** | **54,0** | **35,0** | 
| **78,0** | **64,0** | **44,0** | **63,0** | **99,0** | **18,0** | **16,0** | **53,0** | **73,0** | **76,0** | 
| **25,0** | **45,0** | **19,0** | **64,0** | **20,0** | **39,0** | **16,0** | **47,0** | **31,0** | **59,0** | 
| **92,0** | **77,0** | **97,0** | **3,0** | **77,0** | **12,0** | **63,0** | **37,0** | **35,0** | **20,0** | 
| **68,0** | **31,0** | **99,0** | **86,0** | **14,0** | **45,0** | **84,0** | **58,0** | **6,0** | **50,0** | 
| **66,0** | **72,0** | **99,0** | **14,0** | **72,0** | **13,0** | **11,0** | **27,0** | **12,0** | **74,0** | 
| **2,0** | **2,0** | **53,0** | **37,0** | **85,0** | **59,0** | **54,0** | **29,0** | **35,0** | **52,0** | 

L matrix:

| 1,0 | 0,0 | 0,0 | 0,0 | 0,0 | 0,0 | 0,0 | 0,0 | 0,0 | 0,0 | 
| ---|---|---|---|---|---|---|---|---|---|
| **5,6** | **1,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | 
| **2,1** | **0,3** | **1,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | 
| **5,5** | **1,1** | **1,0** | **1,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | 
| **6,0** | **1,0** | **-0,2** | **-0,8** | **1,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | 
| **1,9** | **0,2** | **-0,5** | **3,5** | **-5,6** | **1,0** | **0,0** | **0,0** | **0,0** | **0,0** | 
| **7,1** | **1,2** | **0,5** | **-8,6** | **7,5** | **-1,0** | **1,0** | **0,0** | **0,0** | **0,0** | 
| **5,2** | **1,0** | **1,4** | **4,0** | **-8,5** | **1,6** | **0,4** | **1,0** | **0,0** | **0,0** | 
| **5,1** | **0,8** | **0,5** | **-5,5** | **3,8** | **-0,4** | **1,1** | **-0,7** | **1,0** | **0,0** | 
| **0,2** | **0,0** | **0,9** | **4,1** | **-3,1** | **0,4** | **-0,6** | **0,5** | **-0,1** | **1,0** | 

**L matrix is lower triangular**  
U matrix:

| 13,0 | 60,0 | 67,0 | 28,0 | 99,0 | 45,0 | 33,0 | 63,0 | 64,0 | 12,0 | 
| ---|---|---|---|---|---|---|---|---|---|
| **0,0** | **-293,9** | **-344,2** | **-97,2** | **-483,9** | **-172,7** | **-146,3** | **-272,8** | **-299,4** | **-28,4** | 
| **0,0** | **0,0** | **57,3** | **-2,5** | **39,9** | **8,0** | **39,6** | **-37,9** | **-20,6** | **49,0** | 
| **0,0** | **0,0** | **0,0** | **9,1** | **30,4** | **-6,8** | **-52,5** | **63,3** | **45,9** | **-51,0** | 
| **0,0** | **0,0** | **0,0** | **0,0** | **25,5** | **-82,2** | **-70,4** | **-5,3** | **24,5** | **-0,0** | 
| **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **-438,8** | **-202,7** | **-279,9** | **-54,8** | **245,9** | 
| **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **-152,4** | **232,9** | **103,7** | **-245,0** | 
| **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **97,4** | **56,3** | **-142,1** | 
| **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **-4,8** | **5,1** | 
| **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **0,0** | **27,1** | 

**U matrix is upper triangular**  
L∙U =

| 13,0 | 60,0 | 67,0 | 28,0 | 99,0 | 45,0 | 33,0 | 63,0 | 64,0 | 12,0 | 
| ---|---|---|---|---|---|---|---|---|---|
| **73,0** | **43,0** | **32,0** | **60,0** | **72,0** | **80,0** | **39,0** | **81,0** | **60,0** | **39,0** | 
| **27,0** | **32,0** | **88,0** | **25,0** | **93,0** | **47,0** | **62,0** | **7,0** | **18,0** | **65,0** | 
| **72,0** | **13,0** | **56,0** | **56,0** | **94,0** | **63,0** | **12,0** | **77,0** | **54,0** | **35,0** | 
| **78,0** | **64,0** | **44,0** | **63,0** | **99,0** | **18,0** | **16,0** | **53,0** | **73,0** | **76,0** | 
| **25,0** | **45,0** | **19,0** | **64,0** | **20,0** | **39,0** | **16,0** | **47,0** | **31,0** | **59,0** | 
| **92,0** | **77,0** | **97,0** | **3,0** | **77,0** | **12,0** | **63,0** | **37,0** | **35,0** | **20,0** | 
| **68,0** | **31,0** | **99,0** | **86,0** | **14,0** | **45,0** | **84,0** | **58,0** | **6,0** | **50,0** | 
| **66,0** | **72,0** | **99,0** | **14,0** | **72,0** | **13,0** | **11,0** | **27,0** | **12,0** | **74,0** | 
| **2,0** | **2,0** | **53,0** | **37,0** | **85,0** | **59,0** | **54,0** | **29,0** | **35,0** | **52,0** | 

**Matrix equals to source one**
# Check invert Matrix algorithm

Invert matrix:

| -0,01698 | -0,01866 | 0,01101 | 0,02626 | -0,00977 | 0,03129 | 0,02579 | -0,01244 | -0,01720 | -0,00823 | 
| ---|---|---|---|---|---|---|---|---|---|
| **0,02953** | **0,06551** | **0,00890** | **-0,05830** | **0,02852** | **-0,07844** | **-0,05762** | **0,02677** | **0,03129** | **-0,02863** | 
| **-0,05195** | **-0,17663** | **0,02715** | **0,15293** | **-0,08710** | **0,24010** | **0,15166** | **-0,07677** | **-0,09297** | **0,01025** | 
| **0,02916** | **0,04747** | **0,02701** | **-0,03785** | **0,03701** | **-0,07696** | **-0,06497** | **0,03539** | **0,01286** | **-0,04474** | 
| **0,07335** | **0,20123** | **-0,01813** | **-0,17230** | **0,10569** | **-0,29770** | **-0,19011** | **0,09670** | **0,11237** | **-0,02568** | 
| **-0,03981** | **-0,10514** | **0,04232** | **0,10769** | **-0,07045** | **0,17603** | **0,10242** | **-0,06269** | **-0,07192** | **-0,01086** | 
| **0,02269** | **0,08465** | **-0,02586** | **-0,08335** | **0,04220** | **-0,11966** | **-0,06404** | **0,04209** | **0,04431** | **0,01490** | 
| **0,05912** | **0,18094** | **-0,07873** | **-0,16384** | **0,08371** | **-0,26186** | **-0,15666** | **0,08952** | **0,12464** | **0,03091** | 
| **-0,11867** | **-0,34901** | **0,04281** | **0,29931** | **-0,16602** | **0,49955** | **0,32330** | **-0,17052** | **-0,20381** | **0,03969** | 
| **-0,01968** | **-0,01910** | **-0,02409** | **0,00823** | **-0,00986** | **0,03281** | **0,02370** | **-0,01328** | **0,00463** | **0,03692** | 

A∙A<sup>-1</sup>:

| 1,0 | 0,0 | 0,0 | 0,0 | -0,0 | -0,0 | 0,0 | 0,0 | -0,0 | 0,0 | 
| ---|---|---|---|---|---|---|---|---|---|
| **-0,0** | **1,0** | **0,0** | **-0,0** | **-0,0** | **0,0** | **0,0** | **0,0** | **-0,0** | **0,0** | 
| **-0,0** | **0,0** | **1,0** | **-0,0** | **0,0** | **-0,0** | **0,0** | **0,0** | **0,0** | **0,0** | 
| **-0,0** | **0,0** | **0,0** | **1,0** | **-0,0** | **-0,0** | **0,0** | **0,0** | **-0,0** | **0,0** | 
| **-0,0** | **0,0** | **0,0** | **-0,0** | **1,0** | **-0,0** | **0,0** | **0,0** | **-0,0** | **-0,0** | 
| **0,0** | **0,0** | **-0,0** | **0,0** | **-0,0** | **1,0** | **-0,0** | **0,0** | **0,0** | **0,0** | 
| **-0,0** | **0,0** | **0,0** | **-0,0** | **0,0** | **0,0** | **1,0** | **-0,0** | **-0,0** | **0,0** | 
| **-0,0** | **0,0** | **-0,0** | **0,0** | **-0,0** | **-0,0** | **0,0** | **1,0** | **-0,0** | **-0,0** | 
| **-0,0** | **0,0** | **0,0** | **-0,0** | **0,0** | **-0,0** | **0,0** | **0,0** | **1,0** | **0,0** | 
| **0,0** | **-0,0** | **-0,0** | **0,0** | **-0,0** | **-0,0** | **0,0** | **0,0** | **0,0** | **1,0** | 

**It is Identity matrix**
# Check solution for different matrix and solvers

## LULinearEquationSolver

> Решим СЛАУ вида A∙x=b  
> Разложим матрицу A на L и U матрицы  
> L∙U∙x=b  
> Обозначит U∙x=y  
> Решим последовательно  
> L∙y=b  
> U∙x=y  
>   
> $$l\_{11} \cdot y\_{1}=b\_{1}$$  
>   
> $$l\_{21} y\_{1}+l\_{22}y\_{2}=b\_{2}$$  
>   
> $$l\_{31} y\_{1}+l\_{32}y\_{2}+l\_{33}y\_{3}=b\_{3}$$  
>   
> $$\sum\_{i=1}^{k}(l\_{ki}y\_{i})=b\_{k}$$  
>   
> Так как $$l\_{ii}=1$$  
>   
> $$y\_{k}=b\_{k}-\sum\_{i=1}^{k-1}(l\_{ki}y\_{i})$$  
>   
> ---  
>   
> $$u\_{nn} \cdot x\_{n}=y\_{n}$$  
>   
> $$u\_{n-1,n} x\_{n}+u\_{n-1,n-1}x\_{n-1}=y\_{n-1}$$  
>   
> $$u\_{n-2,n} x\_{n}+u\_{n-2,n-1}x\_{n-1}+u\_{n-2,n}x\_{n}=y\_{n-2}$$  
>   
> $$\sum\_{i=k}^{n}(u\_{ki}x\_{i})=y\_{k}$$  
>   
> $$x\_{k}=\frac{\sum\_{i=k+1}^{n}(u\_{ki}x\_{i})}{u\_{kk}}$$ 

**LULinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 17,1 | -3,0 | -2,0 | -1,0 | -2,0 | 
| ---|---|---|---|---|
| **-4,0** | **19,1** | **0,0** | **-3,0** | **-4,0** | 
| **-1,0** | **-3,0** | **15,1** | **0,0** | **-3,0** | 
| **-1,0** | **-2,0** | **-4,0** | **15,1** | **-3,0** | 
| **-3,0** | **0,0** | **-2,0** | **-1,0** | **18,1** | 

**Solution: [0.9999999999999996, 1.9999999999999993, 2.9999999999999996, 4.0, 4.999999999999999]**  
Avg error = 0,00%

**LULinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 13,0 | -1,0 | -1,0 | -3,0 | -2,0 | 
| ---|---|---|---|---|
| **-1,0** | **11,0** | **-4,0** | **-2,0** | **0,0** | 
| **-4,0** | **-3,0** | **18,0** | **-1,0** | **-2,0** | 
| **0,0** | **0,0** | **-3,0** | **12,0** | **0,0** | 
| **-1,0** | **0,0** | **0,0** | **-3,0** | **8,0** | 

**Solution: [1.0, 2.0, 3.0, 4.0, 4.999999999999999]**  
Avg error = 0,00%

**LULinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 19,0 | 0,0 | -4,0 | -1,0 | -1,0 | 
| ---|---|---|---|---|
| **-2,0** | **14,0** | **0,0** | **-1,0** | **-4,0** | 
| **-3,0** | **-3,0** | **19,0** | **0,0** | **-3,0** | 
| **-4,0** | **-2,0** | **-4,0** | **14,0** | **0,0** | 
| **-4,0** | **-2,0** | **-2,0** | **-2,0** | **18,0** | 

**Solution: [1.0, 2.0, 3.0, 4.0, 5.0]**  
Avg error = 0,00%

**LULinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 15,0 | -1,0 | -2,0 | -3,0 | -3,0 | 
| ---|---|---|---|---|
| **-2,0** | **16,0** | **-1,0** | **-3,0** | **0,0** | 
| **0,0** | **-1,0** | **14,0** | **-3,0** | **-2,0** | 
| **-1,0** | **-4,0** | **-2,0** | **22,0** | **-4,0** | 
| **-3,0** | **-4,0** | **-3,0** | **-2,0** | **21,0** | 

**Solution: [1.0, 2.0, 3.0000000000000004, 4.0, 5.0]**  
Avg error = 0,00%

**LULinearEquationSolver**  
generated with HilbertMatrixGenerator:

| 1,0 | 0,5 | 0,3 | 0,3 | 0,2 | 
| ---|---|---|---|---|
| **0,5** | **0,3** | **0,3** | **0,2** | **0,2** | 
| **0,3** | **0,3** | **0,2** | **0,2** | **0,1** | 
| **0,3** | **0,2** | **0,2** | **0,1** | **0,1** | 
| **0,2** | **0,2** | **0,1** | **0,1** | **0,1** | 

**Solution: [1.0000000000001998, 1.9999999999960858, 3.000000000017446, 3.999999999972995, 5.000000000013464]**  
Avg error = 0,00%

## JacobiIterationLinearEquationSolver

> Работает и заебись!

**JacobiIterationLinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 19,1 | -3,0 | -1,0 | -2,0 | -3,0 | 
| ---|---|---|---|---|
| **0,0** | **10,1** | **0,0** | **-2,0** | **-1,0** | 
| **-3,0** | **-1,0** | **19,1** | **-4,0** | **-4,0** | 
| **-3,0** | **-2,0** | **-4,0** | **20,1** | **-1,0** | 
| **-4,0** | **-1,0** | **-2,0** | **-2,0** | **18,1** | 

**Solution: [0.9281430422053696, 1.9472220795985724, 2.897372044625214, 3.9188745290219917, 4.918761809371236]**  
Avg error = 3,38%

**JacobiIterationLinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 20,0 | -1,0 | -4,0 | -3,0 | 0,0 | 
| ---|---|---|---|---|
| **-4,0** | **15,0** | **0,0** | **-2,0** | **-4,0** | 
| **-1,0** | **-2,0** | **12,0** | **-1,0** | **-2,0** | 
| **-3,0** | **0,0** | **0,0** | **11,0** | **0,0** | 
| **-4,0** | **-2,0** | **-2,0** | **-2,0** | **16,0** | 

**Solution: [0.9515679850132842, 1.920016091146117, 2.930330307414032, 3.97156735552962, 4.925712076403851]**  
Avg error = 2,67%

**JacobiIterationLinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 14,0 | -4,0 | -3,0 | 0,0 | -3,0 | 
| ---|---|---|---|---|
| **-3,0** | **14,0** | **0,0** | **0,0** | **0,0** | 
| **0,0** | **-3,0** | **13,0** | **-3,0** | **-1,0** | 
| **0,0** | **0,0** | **-1,0** | **9,0** | **-4,0** | 
| **-1,0** | **-4,0** | **-2,0** | **-1,0** | **16,0** | 

**Solution: [0.9184326836278732, 1.962104739301831, 2.9302755012308643, 3.9293357738054846, 4.938853732706521]**  
Avg error = 3,07%

**JacobiIterationLinearEquationSolver**  
generated with DiagonallyDominantMatrixGenerator:

| 7,0 | -4,0 | 0,0 | -1,0 | -1,0 | 
| ---|---|---|---|---|
| **0,0** | **22,0** | **-3,0** | **-4,0** | **-1,0** | 
| **0,0** | **-2,0** | **14,0** | **-2,0** | **-2,0** | 
| **0,0** | **-4,0** | **-2,0** | **15,0** | **-2,0** | 
| **-1,0** | **-4,0** | **-3,0** | **0,0** | **14,0** | 

**Solution: [0.8802061120678797, 1.9432109078599331, 2.9333347744158567, 3.923966472794645, 4.916386187493137]**  
Avg error = 4,12%

**JacobiIterationLinearEquationSolver**  
generated with HilbertMatrixGenerator:

| 1,0 | 0,5 | 0,3 | 0,3 | 0,2 | 
| ---|---|---|---|---|
| **0,5** | **0,3** | **0,3** | **0,2** | **0,2** | 
| **0,3** | **0,3** | **0,2** | **0,2** | **0,1** | 
| **0,3** | **0,2** | **0,2** | **0,1** | **0,1** | 
| **0,2** | **0,2** | **0,1** | **0,1** | **0,1** | 

**Solution: [560.9782831915336, 1171.9048908844966, 1533.0714360461543, 1778.3455708681145, 1957.3779420187977]**  
Avg error = 49780,33%

